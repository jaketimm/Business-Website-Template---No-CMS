<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Page Template</title>
    <link rel="stylesheet" href="global_styles.css">
    <style>
        .blog-preview {
            border: 1px solid #ddd;
            padding: 16px;
            margin: 12.5%;
            margin-top: 0;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 75%;
        }

        .blog-preview img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
        }

        .blog-preview h2 {
            margin: 16px 0 8px;
        }

        .blog-preview p {
            color: #555;
        }

        .blog-preview a {
            color: #000;
            font-weight: bold;
        }
    </style>
</head>

<body class="blog-preview-page">

    <!-- ============================================ -->
    <!--       Standard Navigation & dropdown         -->
    <!-- ============================================ -->

    <header id="cs-navigation">
        <!--Nav Logo-->
        <a href="index.html" class="cs-logo" aria-label="back to home">
            <img src="images/logo.jpg" alt="logo" width="210" height="29" aria-hidden="true" decoding="async">
        </a>
        <!--Navigation List-->
        <nav class="cs-nav" role="navigation">
            <!--Mobile Nav Toggle-->
            <button class="cs-toggle" aria-label="mobile menu toggle">
                <div class="cs-box" aria-hidden="true">
                    <span class="cs-line cs-line1" aria-hidden="true"></span>
                    <span class="cs-line cs-line2" aria-hidden="true"></span>
                    <span class="cs-line cs-line3" aria-hidden="true"></span>
                </div>
            </button>
            <!-- We need a wrapper div so we can set a fixed height on the cs-ul in case the nav list gets too long from too many dropdowns being opened and needs to have an overflow scroll. This wrapper acts as the background so it can go the full height of the screen and not cut off any overflowing nav items while the cs-ul stops short of the bottom of the screen, which keeps all nav items in view no matter how mnay there are-->
            <div class="cs-ul-wrapper">
                <ul id="cs-expanded" class="cs-ul" aria-expanded="false">
                    <li class="cs-li cs-dropdown" tabindex="0">
                        <span class="cs-li-link">
                            Home
                            <img class="cs-drop-icon" src="https://www.svgrepo.com/show/495005/arrow-down.svg"
                                alt="dropdown icon" width="15" height="15" decoding="async" aria-hidden="true">
                        </span>
                        <ul class="cs-drop-ul">
                            <li class="cs-drop-li">
                                <a href="index.html" class="cs-li-link cs-drop-link">Home</a>
                            </li>
                            <li class="cs-drop-li">
                                <a href="home_page_2.html" class="cs-li-link cs-drop-link">Other Resources</a>
                            </li>
                        </ul>
                    </li>
                    <li class="cs-li">
                        <a href="about_page.html" class="cs-li-link">
                            About
                        </a>
                    </li>
                    <!--Copy and paste this cs-dropdown list item and replace any .cs-li with this cs-dropdown group to make a new dropdown and it will work-->
                    <li class="cs-li cs-dropdown" tabindex="0">
                        <span class="cs-li-link">
                            Services
                            <img class="cs-drop-icon" src="https://www.svgrepo.com/show/495005/arrow-down.svg"
                                alt="dropdown icon" width="15" height="15" decoding="async" aria-hidden="true">
                        </span>
                        <ul class="cs-drop-ul">
                            <li class="cs-drop-li">
                                <a href="services_page_1.html" class="cs-li-link cs-drop-link">Services 1</a>
                            </li>
                            <li class="cs-drop-li">
                                <a href="product_page_2.html" class="cs-li-link cs-drop-link">Services 2</a>
                            </li>
                            <li class="cs-drop-li">
                                <a href="product_page.html" class="cs-li-link cs-drop-link">Product</a>
                            </li>
                            <li class="cs-drop-li">
                                <a href="services_page_2.html" class="cs-li-link cs-drop-link">Pricing</a>
                            </li>
                        </ul>
                    </li>
                    <li class="cs-li">
                        <a href="gallery_page.html" class="cs-li-link">
                            Gallery
                        </a>
                    </li>
                    <li class="cs-li">
                        <a href="blog.html" class="cs-li-link cs-active">
                            Blog
                        </a>
                    </li>
                    <li class="cs-li">
                        <a href="event_page.html" class="cs-li-link">
                            Events
                        </a>
                    </li>
                    <li class="cs-li">
                        <a href="contact_page.html" class="cs-li-link">
                            Contact Us
                        </a>
                    </li>
                </ul>
            </div>
        </nav>
        <!--Dark Mode toggle, uncomment button code if you want to enable a dark mode toggle-->
        <!-- <button id="dark-mode-toggle" aria-label="dark mode toggle">
        <svg class="cs-moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 480" style="enable-background:new 0 0 480 480" xml:space="preserve"><path d="M459.782 347.328c-4.288-5.28-11.488-7.232-17.824-4.96-17.76 6.368-37.024 9.632-57.312 9.632-97.056 0-176-78.976-176-176 0-58.4 28.832-112.768 77.12-145.472 5.472-3.712 8.096-10.4 6.624-16.832S285.638 2.4 279.078 1.44C271.59.352 264.134 0 256.646 0c-132.352 0-240 107.648-240 240s107.648 240 240 240c84 0 160.416-42.688 204.352-114.176 3.552-5.792 3.04-13.184-1.216-18.496z"/></svg>
        <img class="cs-sun" aria-hidden="true" src="https://csimg.nyc3.cdn.digitaloceanspaces.com/Icons%2Fsun.svg" decoding="async" alt="moon" width="15" height="15">
    </button> -->
    </header>


    <!-- ============================================ -->
    <!--                 Title/Topper                 -->
    <!-- ============================================ -->

    <div id="cs-content-831">
        <h1 class="cs-title-decorative">Blog</h1>
        <div class="cs-title-decorative-second-line">Check Out Our Lastest News and Updates</div>
    </div>


    <div id="content">Loading...</div>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        async function loadBlogPreviews() {
            const blogFolder = 'blog/';
            const response = await fetch('blog/blogFiles.json');
            const blogFiles = await response.json(); // Get the list of .md files

            const contentDiv = document.getElementById('content');
            contentDiv.innerHTML = '';

            for (const file of blogFiles) {
                try {
                    const response = await fetch(blogFolder + file);
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const markdown = await response.text();
                    const html = marked.parse(markdown);

                    // Extract metadata from markdown
                    const titleMatch = html.match(/<h2>(.*?)<\/h2>/);
                    const title = titleMatch ? titleMatch[1] : 'Untitled';

                    // Simple regex to find the first paragraph
                    const paragraphMatch = html.match(/<p>(.*?)<\/p>/);
                    const description = paragraphMatch ? paragraphMatch[1] : 'No description available';

                    // Extract metadata using regex from the markdown
                    const metaData = {
                        title: 'Untitled',
                        url: file,
                        description: description,
                        author: 'Unknown',
                        date: 'Unknown',
                        tags: [],
                        image: 'blog/default_image.jpg',
                        imageAlt: 'Image'
                    };

                    const metaMatch = markdown.match(/title:\s*(.*?)\nurl:\s*(.*?)\ndescription:\s*(.*?)\nauthor:\s*(.*?)\ndate:\s*(.*?)\ntags:\s*([\s\S]*?)\nimage:\s*(.*?)\nimageAlt:\s*(.*)/);
                    if (metaMatch) {
                        metaData.title = metaMatch[1];
                        metaData.url = metaMatch[2];
                        metaData.description = metaMatch[3];
                        metaData.author = metaMatch[4];
                        metaData.date = metaMatch[5];
                        metaData.tags = metaMatch[6].trim().split(/\s+/);
                        metaData.image = metaMatch[7];
                        metaData.imageAlt = metaMatch[8];
                    }

                    // Create blog preview card
                    const cardHtml = `
                        <div class="blog-preview">
                            <picture>
                                <img src="${blogFolder + metaData.image}" alt="${metaData.imageAlt}">
                            </picture>
                            <h2>${metaData.title}</h2>
                            <p>${metaData.description}</p>
                            <a href="post.html?post=${encodeURIComponent(file)}">Read more</a>
                        </div>
                    `;
                    contentDiv.innerHTML += cardHtml;

                } catch (error) {
                    console.error('Error loading post:', error);
                    contentDiv.innerHTML += `<p>Error loading post: ${error.message}</p>`;
                }
            }
        }

        // Load blog previews when the page loads
        window.onload = loadBlogPreviews;
    </script>

    <!-- Link to gloabl Javascript file -->
    <script src="page_scripts.js"></script>
</body>

</html>