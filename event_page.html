<!DOCTYPE html>
<html>
<head>
  <title>Google Sheets API Example</title>
  <script src="https://apis.google.com/js/api.js"></script>
  <script>
    var API_KEY = 'AIzaSyBoE1l0ANCfKp7nbESVXprAJdonqRsvwC0'; //From Google Project Page
    var SHEET_ID = '1Tp5iSPMOH0D6Up66iLtwkhGLbmGcJBmaas3PCcs4Xm4'; //part of Google Sheet URL between d/ and the /edit
    var RANGE = 'Sheet1!A2:D4'; // Modify as needed

    function onApiLoad() {
      gapi.load('client', initClient);
    }

    function initClient() {
      gapi.client.init({
        apiKey: API_KEY,
        discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"]
      }).then(function () {
        console.log('API client initialized.');
        readSheetData();
      }).catch(function(error) {
        console.error('Error initializing API client:', error);
      });
    }

    function readSheetData() {
      gapi.client.sheets.spreadsheets.values.get({
        spreadsheetId: SHEET_ID,
        range: RANGE
      }).then(function(response) {
        var values = response.result.values;
        if (values && values.length > 0) {
          var output = '<table border="1" cellpadding="5">';
          for (var i = 0; i < values.length; i++) {
            output += '<tr>';
            for (var j = 0; j < values[i].length; j++) {
              output += '<td>' + (values[i][j] || '') + '</td>';
            }
            output += '</tr>';
          }
          output += '</table>';
          document.getElementById('output').innerHTML = output;
        } else {
          document.getElementById('output').innerText = 'No data found.';
        }
      }).catch(function(error) {
        console.error('Error reading data:', error);
        document.getElementById('output').innerText = 'Error fetching data.';
      });
    }
  </script>
</head>
<body onload="onApiLoad()">
  <h1>Google Sheets API Data</h1>
  <div id="output">Loading...</div>
</body>
</html>